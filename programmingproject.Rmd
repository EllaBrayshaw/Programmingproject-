---
title: "Project"
author: "Ella Brayshaw"
date: "2023-03-07"
output: html_document
---
# MATH5090 - Assignment 2 
## Ella Brayshaw 
## Student number : 201669865

### Introduction
In this report I will be describing and evaluating the BOP2 trial design. I will begin by explaining the key features and steps. Then I will apply the BOP2 method to the reserve trial scenario that we have been provided with. 

We are interested in looking at the progression between stage 1 to stage 2, then from stage 2 to a definitive phase III trial; these progressions are based on the posterior probability of futility. To begin to show the meaning of this idea, I will set $y_i$ to be the number of observations in the $n_i$ particpants ($n_1$ = number of participants in stage 1 and $n_2 = n_1 + \tilde{n_2}$ = participants at the end of stage 2 ). $y_i$ follows a binomial distribution with probability of success, $\theta$, following a  prior beta distribution with parameters $a_0$ and $b_0$.

After observing the response $y_i$ we can then calculate the posterior distribution using Bayes Theorem :  
$$ P(\theta | y_i) = \frac{P(y_i|\theta)*P(\theta)}{P(y_i)} $$
 This results in the posterior probability also following a beta distribution : $P(\theta|y_i)$ ~ beta($a_i$, $b_i$), where $a_i = a + y_i$ and $b_i = b + n_i - y_i$. 
 
We use this posterior probability to determine progression through the probability of futility. We define the probability of futility as the probability of a response, $\theta < 0.5$ given the observed responses : 
$$P(\theta < 0.5 | y_i)$$. We ideally want this probability to be low as the probability of observing is response is poor. To decide whether we carry on to the next stage we need to define a threshold which varies at each stage to compare this too, we define this threshold to be $$C(n_i) = 1 - \lambda(\frac{n_i}{n_2})^{\gamma}$$ In this report we will investigate choices of these stopping rule parameters $\lambda$ and $\gamma$
I defined functions which calculated the probability of futility as well as the thresholds in the Functions. R folder and these can be called by :

```{r}
source("./R/functions.R")
#probs_futility <- prob_futility(a1, b1, a2, b2) 

#thresholds <- progression_threshold(lambda, gamma, n1, n2)

```




```{r}

```



